# Run all the tests in the tests folder, including a coverage analysis
pytest_commit:
  stage: test
  before_script:
    - apt update && apt install -y git
    - pixi install -e dev
  script:
    - pixi run -e dev pre-commit run --all
    - pixi run -e dev pytest --cov=src --cov-report term ./tests

# Explicitly run pytest for merge request commits
pytest_merge_request:
  extends: pytest_commit
  rules:
    - if: $CI_PIPELINE_SOURCE == 'merge_request_event'
